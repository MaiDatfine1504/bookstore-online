<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  header {
    background-color: #fff;
    padding: 14px 30px;
    border-bottom: 1.5px solid #eee;
    font-family: 'Roboto', sans-serif;
  }

  .nav-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    flex-wrap: nowrap;
  }

  .nav-left, .nav-center, .nav-right {
    display: flex;
    align-items: center;
    gap: 20px;
    flex-shrink: 0;
  }

  .nav-left {
    min-width: 240px;
    flex-wrap: nowrap;
  }

  .nav-left a.logo {
    font-size: 22px;
    font-weight: bold;
    color: #333;
    text-decoration: none;
    margin-right: 20px;
    white-space: nowrap;
  }

  .nav-left a,
  .nav-left .dropdown-toggle {
    cursor: pointer;
    color: #000;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s ease;
    white-space: nowrap;
  }

  .nav-left a:hover,
  .nav-left .dropdown-toggle:hover {
    color: #3559E0;
  }

  .dropdown {
    position: relative;
  }

  .dropdown-content {
    display: none;
    position: absolute;
    top: 32px;
    left: 0;
    background-color: #fff;
    border: 1px solid #ddd;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: 999;
    min-width: 160px;
    border-radius: 6px;
  }

  .dropdown-content a {
    display: block;
    padding: 10px 14px;
    color: #333;
    text-decoration: none;
    font-size: 14px;
  }

  .dropdown:hover .dropdown-content {
    display: block;
  }

  .search-box {
    flex: 1;
    display: flex;
    align-items: center;
  }

  .search-box input[type="text"] {
    background-color: #f2f2f2;
    padding: 8px 14px;
    border: 1px solid #ccc;
    border-radius: 25px;
    width: 100%;
    font-size: 14px;
    transition: border-color 0.3s ease;
  }

  .search-box input[type="text"]:focus {
    outline: none;
    border-color: #3559E0;
  }

  .search-box button {
    background-color: #3559E0;
    padding: 10px 25px;
    font-size: 12px;
    font-weight: bold;
    border: none;
    color: white;
    border-radius: 25px;
    margin-left: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .search-box button:hover {
    background-color: #0F2167;
  }

  .nav-right a {
    text-decoration: none;
    font-weight: 400;
    padding: 10px 16px;
    border-radius: 25px;
    transition: background-color 0.3s ease, color 0.3s ease;
    white-space: nowrap;
    font-size: 14px;
  }

  .login {
    background-color: #3559E0;
    color: #fff;
    border: 1.5px solid #3559E0;
  }

  .login:hover {
    background-color: #0F2167;
    border-color: #0F2167;
  }

  .register {
    background-color: #fff;
    color: #3559E0;
    border: 1.5px solid #3559E0;
  }

  .register:hover {
    background-color: #0F2167;
    border-color: #0F2167;
    color: #fff;
  }

  .nav-icon-link {
    display: flex;
    align-items: center;
    gap: 6px;
    color: #333;
    font-weight: 500;
    padding: 8px 14px;
    border-radius: 25px;
    text-decoration: none;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  .nav-icon-link:hover {
    background-color: #f0f4ff;
    color: #3559E0;
  }

  .nav-icon-link i {
    width: 18px;
    height: 18px;
  }

  .suggestions {
    position: absolute;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 6px;
    width: 100%;
    z-index: 999;
    max-height: 300px;
    overflow-y: auto;
  }

  .suggestion-item {
    display: flex;
    padding: 12px 16px;
    border-bottom: 1px solid #f2f2f2;
    text-decoration: none;
    color: #333;
  }

  .suggestion-item:hover {
    background-color: #f4f4f4;
  }

  .suggestion-item img {
    width: 50px;
    height: 70px;
    margin-right: 10px;
  }

  @media (max-width: 768px) {
    .nav-container {
      flex-wrap: wrap;
      flex-direction: column;
      align-items: flex-start;
    }

    .search-box {
      width: 100%;
      margin-top: 10px;
    }

    .search-box input[type="text"] {
      width: 100%;
    }
  }
</style>

<header>
  <div class="nav-container">
    <!-- Logo + menu -->
    <div class="nav-left">
      <a href="/" class="logo">üìö BookStore</a>
      <a href="/">Trang ch·ªß</a>
      <a href="/about">Gi·ªõi thi·ªáu</a>
      <a href="/contact">Li√™n h·ªá</a>
      <a href="/sell">ƒê·∫∑t s√°ch</a>
      <div class="dropdown">
        <span class="dropdown-toggle">Th·ªÉ lo·∫°i ‚ñæ</span>
        <div class="dropdown-content">
          <a href="/genre/{{ g|lower }}">{{ g }}</a>
        </div>
      </div>
    </div>

    <!-- Search -->
    <div class="nav-center">
      <form class="search-box" action="/search" method="get" autocomplete="off">
        <input type="text" name="q" id="live-search" placeholder="T√¨m ki·∫øm s√°ch...">
        <button type="submit">T√¨m</button>
      </form>
      <div id="suggestions" class="suggestions"></div>
    </div>

    <!-- T√†i kho·∫£n / gi·ªè h√†ng -->
    <div class="nav-right">
      {% if session.username and session.get("role") == "customer" %}
        <a href="{{ url_for('view_cart') }}" class="nav-icon-link">
          <i data-feather="shopping-cart"></i>{{ cart_count }} items
        </a>
        <a href="{{ url_for('homepage') }}" class="nav-icon-link">
          <i data-feather="user"></i>T√†i kho·∫£n
        </a>
        <a href="{{ url_for('logout') }}" class="nav-icon-link">
          <i data-feather="log-out"></i>ƒêƒÉng xu·∫•t
        </a>
      {% else %}
        <a href="{{ url_for('login') }}" class="login">ƒêƒÉng nh·∫≠p</a>
        <a href="{{ url_for('register') }}" class="register">ƒêƒÉng k√Ω</a>
      {% endif %}
    </div>
  </div>
</header>

<script>
  feather.replace();

  document.getElementById('live-search').addEventListener('keyup', function () {
    let query = this.value.trim();
    let suggestionsBox = document.getElementById('suggestions');

    if (query.length < 2) {
      suggestionsBox.innerHTML = "";
      return;
    }

    fetch(`/autocomplete?q=${encodeURIComponent(query)}`)
      .then(res => res.json())
      .then(data => {
        console.log("DATA:", data);

        let html = "";

        data.forEach(item => {
          if (item.type === 'brand') {
            html += `
              <a href="/brand/${item.slug}" class="suggestion-item">
                <div>
                  <strong>Th∆∞∆°ng hi·ªáu: ${item.name}</strong><br>
                  <span>${item.description}</span>
                </div>
              </a>
            `;
          } else {
            html += `
              <a href="/book/${item.slug}" class="suggestion-item">
                <img src="/static/images/${item.image}" alt="${item.title}">
                <div>
                  <strong>${item.title}</strong><br>
                  <span>${item.price}</span>
                </div>
              </a>
            `;
          }
        });

        suggestionsBox.innerHTML = html;
      });
  });
</script>

